<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>d20 - roll some dice</title>
    <style type="text/css">
        .label {
            width: 30px;
            text-align: right;
            display: inline-block;
        }
        input {
            padding: 0 5px;
            width: 12px;
        }
    </style>
</head>
<body>
    <div id="app">
        <dice :sides="4"></dice>
        <dice :sides="6"></dice>
        <dice :sides="8"></dice>
        <dice :sides="10"></dice>
        <dice :sides="12"></dice>
        <dice :sides="20"></dice>
    </div>
<script src="vue@2.5.17.js"></script>
<script type="text/javascript">
Vue.component('dice', {
    template: '#dice',
    props: ['sides'],
    computed: {
        humanize_results: function(){
            if (this.error) { return this.error; }
            if (this.results.length < 1) { return "" };
            if (this.results.length == 1) { return this.results[0]; };
            return this.results.join(" + ") + " = " + this.results.reduce(function(t, n){ return t+n; });
        },
    },
    methods: {
        roll: function(e){
            this.error = null;
            var fresh = [];

            // simple validation
            if (parseInt(this.count) > 100) { this.error = "too many"; return; }

            for (var i = 0; i < parseInt(this.count); i++) {
                fresh.push(this.rand());
            }

            this.results = fresh;
        },
        rand: function(){
            return Math.floor(Math.random() * Math.floor(this.numOfSides)) + 1;
        },
    },
    data: function(){
        return {
            results: [],
            count: null,
            error: null,
            numOfSides: parseInt(this.sides),
        };
    },
    template: `<div class="dice">
        <input type="text" name="count" v-model="count" placeholder="0">
        <span class="label">d{{sides}}</span>
        <button @click="roll">Roll</button>
        <span>{{humanize_results}}</span>
    </div>`,
});

new Vue({ el: '#app' });
</script>
</body>
</html>
